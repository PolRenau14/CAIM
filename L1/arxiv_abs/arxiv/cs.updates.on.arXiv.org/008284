Sleep plays a vital role in human health, both mental and physical. Sleep disorders like sleep apnea
are increasing in prevalence, with the rapid increase in factors like obesity. Sleep apnea is most
commonly treated with Continuous Positive Air Pressure (CPAP) therapy. Presently, however, there
is no mechanism to monitor a patient's progress with CPAP. Accurate detection of sleep stages from
CPAP flow signal is crucial for such a mechanism. We propose, for the first time, an automated sleep
staging model based only on the flow signal. Deep neural networks have recently shown high accuracy
on sleep staging by eliminating handcrafted features. However, these methods focus exclusively
on extracting informative features from the input signal, without paying much attention to the
dynamics of sleep stages in the output sequence. We propose an end-to-end framework that uses a combination
of deep convolution and recurrent neural networks to extract high-level features from raw flow
signal with a structured output layer based on a conditional random field to model the temporal transition
structure of the sleep stages. We improve upon the previous methods by 10% using our model, that can
be augmented to the previous sleep staging deep learning methods. We also show that our method can
be used to accurately track sleep metrics like sleep efficiency calculated from sleep stages that
can be deployed for monitoring the response of CPAP therapy on sleep apnea patients. Apart from the
technical contributions, we expect this study to motivate new research questions in sleep science.
